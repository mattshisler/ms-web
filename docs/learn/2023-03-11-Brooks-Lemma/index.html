<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matthew Shisler">
<meta name="dcterms.date" content="2023-03-12">
<meta name="description" content="An explanation of Brook’s Lemma.">

<title>MS - Brook’s Lemma</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">MS</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../learn.html">
 <span class="menu-text">Learn</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes.html">
 <span class="menu-text">Notes</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Brook’s Lemma</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Stochastic Processes</div>
  </div>
  </div>

<div>
  <div class="description">
    An explanation of Brook’s Lemma.
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    Matthew Shisler 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://statistics.sciences.ncsu.edu/">
            North Carloina State University - Department of Statistics
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 12, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">

</div>
<p>Here we will explore Brook’s Lemma and some of its implications and consequences. Brook’s lemma is particularly useful in the context of spatial statistics.</p>
<p>Consider a discrete Markov Chain <span class="math inline">\(\{X_t, t \in T \}\)</span> with finite state space.</p>
<p>Recall the <em>Markov Property</em>. The transition probabilities for <span class="math inline">\(X_t\)</span> depend only on the previous state <span class="math inline">\(X_{t-1}\)</span>. One way to describe the Markov property in the context of a time-ordered evolving process is to say that, conditioned on the present, the past and future are independent. <span class="math display">\[
\Pr(X_t = s_t|X_{t-1}=s_{t-1},\dots,X_0 = s_0) = \Pr(X_t = s_t|X_{t-1}=s_{t-1})
\]</span> where <span class="math inline">\(s_t\)</span> is the state at stage <span class="math inline">\(t\)</span>.</p>
<p>In this setting, we can factor the joint probability mass/density function, denoted <span class="math inline">\(p(\,\cdot\,)\)</span>, of <span class="math inline">\(t\)</span> random variables, using the definition of conditional probability and the Markov Property. Given an initial state <span class="math inline">\(X_0\)</span>,</p>
<p><span class="math display">\[
\begin{align*}
p(X_t,X_{t-1},\dots,X_1|X_0) &amp;= p(X_{t}|X_{t-1},\dots,X_1,X_0) \cdot p(X_{t-1},\dots,X_1|X_0)\\
               &amp;= p(X_{t}|X_{t-1},\dots,X_1,X_0)\cdot p(X_{t-1}|X_{t-2},\dots,X_1,X_0)\cdot p(X_{t-2},\dots,X_1|X_0)\\
               &amp;\quad \vdots\\
               &amp;= p(X_{t}|X_{t-1},\dots,X_1,X_0)\cdot p(X_{t-1}|X_{t-2},\dots,X_1,X_0)\cdot \dots \cdot p(X_1|X_0)\\
               &amp;= p(X_{t}|X_{t-1})\cdot p(X_{t-1}|X_{t-2})\cdot \dots \cdot p(X_1|X_0)\\
               &amp;= \prod_{j=1}^t p(X_j|X_{j-1})
\end{align*}
\]</span> Above, in the first several equalities we apply the definition of conditional probability to write a <span class="math inline">\(k\)</span>-variate joint probability density as the product of a univariate conditional and <span class="math inline">\((k-1)\)</span>-variate (joint) marginal probability densities. In the penultimate line, we apply the Markov Property to conclude that each conditional probability depends only on the immediately preceding variate in the Markov chain. The last line puts the expression into product notation.</p>
<p>This approach works in the case of a “natural ordering” or “favored direction” of the Markov Chain. Commonly an ordering is implied by the idea that the stochastic process is evolving over time. The process starts at an initial state <span class="math inline">\(X_0\)</span>, then <span class="math inline">\(X_1\)</span> follows <span class="math inline">\(X_0\)</span>, <span class="math inline">\(X_2\)</span> follows <span class="math inline">\(X_1\)</span>, …, <span class="math inline">\(X_t\)</span> follows <span class="math inline">\(X_{t-1}\)</span>, and so on. Under the Markov property it is not useful to specify a model through conditional probabilities of the form <span class="math inline">\(P(X_{t-1}|X_t)\)</span> (past event conditioned on future event) because by time <span class="math inline">\(t\)</span> the past event at time <span class="math inline">\(t-1\)</span> will have already been “realized” in the stochastic process. That is the state at time <span class="math inline">\(t\)</span> has no influence on the state at time <span class="math inline">\(t-1\)</span> in the system.</p>
<p>Note: conditional probabilities of the form <span class="math inline">\(P(X_{t-1}|X_t)\)</span> might be interesting from the perspective of an observer who perceives the state of the system at time <span class="math inline">\(t\)</span> and wishes to characterize the probability of the previous state.</p>
<p>But this natural ordering is not present in all stochastic processes. The most basic example might be the case where <span class="math display">\[
\Pr(X_t = s_t|X_{t-1}=s_{t-1},\dots,X_0 = s_0) = \Pr(X_t = s_t|X_{t-1}=s_{t-1})
\]</span></p>
<p>(MORE CONTENT)</p>
<p>An application of Brook’s Lemma to Gaussian data.</p>
<p>Consider the simple case of a spatial domain partitioned into two areal units, each neighbors of the other, with univariate outcome <span class="math inline">\(X_i\)</span> at each unit <span class="math inline">\(i=1,2\)</span>.</p>
<p>One option is to specify a conditionally autoregressive model to capture spatial dependencies.</p>
<p><span class="math display">\[
\begin{align*}
X_1 \,|\, X_2 &amp;\sim \text{N}(b_{12}X_2, \tau_1^2)\\
X_2 \,|\, X_1 &amp;\sim \text{N}(b_{21}X_1, \tau_2^2)\\
\end{align*}
\]</span></p>
<p>The joint density of <span class="math inline">\((X_1, X_2)\)</span> follows by application of Brook’s Lemma,</p>
<p><span class="math display">\[
\begin{align*}
p(x_1,x_2) &amp;= \frac{p(x_1|x_2)}{p(x_{1,0}|x_2)}\frac{p(x_2|x_{1,0})}{p(x_{1,0}|x_{2,0})}p(x_{1,0},x_{2,0})\\
           &amp;\propto  \frac{p(x_1|x_2)}{p(x_{1,0}|x_2)}p(x_2|x_{1,0})\\
           &amp;\propto  \frac{\exp\left\{-\frac{1}{2}(x_1 - b_{12}x_2)^2\right\}}{\exp\left\{-\frac{1}{2}(x_{1,0} - b_{12}x_2)^2\right\}} \exp\left\{-\frac{1}{2}(x_2 - b_{21}x_{1,0})^2\right\}\\
           &amp;=  \frac{\exp\left\{-\frac{1}{2}(x_1 - b_{12}x_2)^2\right\}}{\exp\left\{-\frac{1}{2}((0) - b_{12}x_2)^2\right\}} \exp\left\{-\frac{1}{2}(x_2 - b_{21}(0))^2\right\} &amp; \quad \text{choose } (x_{1,0},x_{2,0}) = (0,0)\\
           &amp;=  \frac{\exp\left\{-\frac{1}{2\tau^2_1}(x^2_1 - 2b_{12}x_1x_2 + b_{12}^2x_2^2)\right\}}{\exp\left\{-\frac{1}{2\tau^2_1}b_{12}^2x_2^2\right\}} \exp\left\{-\frac{1}{2\tau^2_2}x_2^2\right\}\\
           &amp;= \exp\left\{-\frac{1}{2}\left[\frac{1}{\tau^2_1}\left(x_1^2 - 2b_{12}x_1x_2 + x_2^2\right) - \frac{1}{\tau_1^2}x_2^2 + \frac{1}{\tau_2^2}x_2^2\right]\right\}\\
           &amp;= \exp\left\{-\frac{1}{2}\left[\frac{1}{\tau^2_1}\left(x_1^2 - 2b_{12}x_1x_2\right) + \frac{1}{\tau_2^2}x_2^2\right]\right\}\\
           &amp;= \exp\left\{-\frac{1}{2}\left[\frac{1}{\tau^2_1}x_1^2 - 2\frac{b_{12}}{\tau^2_1}x_1x_2 + \frac{1}{\tau_2^2}x_2^2\right]\right\}\\
           &amp;= \exp\left\{-\frac{1}{2}\left[\frac{1}{\tau^2_1}x_1^2 - \frac{b_{12}}{\tau^2_1}x_1x_2 - \frac{b_{21}}{\tau^2_2}x_1x_2 +\frac{1}{\tau_2^2}x_2^2\right]\right\} &amp; \quad \text{symmetry condition, } \frac{b_{12}}{\tau^2_1} =  \frac{b_{21}}{\tau^2_2}\\
           &amp;= \exp\left\{-\frac{1}{2}\left[
           \begin{pmatrix}
           x_1 &amp; x_2
           \end{pmatrix}
           \begin{pmatrix}
           \tau^{-2}_1 &amp; -\tau^{-2}_1b_{12} \\
           -\tau^{-2}_2b_{21} &amp; \tau^{-2}_2
           \end{pmatrix}
           \begin{pmatrix}
           x_1\\
           x_2
           \end{pmatrix}
           \right]\right\} &amp; \quad \text{matrix representation}\\
           &amp;= \exp\left\{-\frac{1}{2}\left[
           \begin{pmatrix}
           x_1 &amp; x_2
           \end{pmatrix}
            \begin{pmatrix}
           \tau^{-2}_1 &amp; 0 \\
           0 &amp; \tau^{-2}_2
           \end{pmatrix}
           \begin{pmatrix}
           1 &amp; -b_{12} \\
           -b_{21} &amp; 1
           \end{pmatrix}
           \begin{pmatrix}
           x_1\\
           x_2
           \end{pmatrix}
           \right]\right\}\\
           &amp;= \exp\left\{\frac{1}{2}\mathbf{x}^T\mathbf{D}^{-1}(\mathbf{I} - \mathbf{B})\mathbf{x}\right\}
\end{align*}
\]</span> Which suggests that $(X_1, X_2) (, )</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>